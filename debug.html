<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Telegram Bot</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .error { color: red; }
        .success { color: green; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>Диагностика Telegram Bot</h1>
    
    <div id="status">
        <h2>Статус загрузки:</h2>
        <p id="html-status" class="info">HTML загружен ✓</p>
        <p id="js-status" class="error">JavaScript загружается...</p>
        <p id="css-status" class="error">CSS загружается...</p>
    </div>
    
    <div id="errors">
        <h2>Ошибки:</h2>
        <ul id="error-list"></ul>
    </div>
    
    <div id="telegram-info">
        <h2>Информация о Telegram:</h2>
        <p id="telegram-status" class="error">Проверяется...</p>
    </div>
    
    <script>
        console.log('Debug script started');
        
        // Проверяем загрузку ресурсов
        function checkResources() {
            const jsStatus = document.getElementById('js-status');
            const cssStatus = document.getElementById('css-status');
            
            // Проверяем JavaScript
            fetch('/telegram-bot/assets/index-DNYZKdR7.js')
                .then(response => {
                    if (response.ok) {
                        jsStatus.textContent = 'JavaScript загружен ✓';
                        jsStatus.className = 'success';
                    } else {
                        jsStatus.textContent = 'JavaScript ошибка: ' + response.status;
                        jsStatus.className = 'error';
                    }
                })
                .catch(error => {
                    jsStatus.textContent = 'JavaScript ошибка: ' + error.message;
                    jsStatus.className = 'error';
                });
            
            // Проверяем CSS
            fetch('/telegram-bot/assets/index-DhBXR_dc.css')
                .then(response => {
                    if (response.ok) {
                        cssStatus.textContent = 'CSS загружен ✓';
                        cssStatus.className = 'success';
                    } else {
                        cssStatus.textContent = 'CSS ошибка: ' + response.status;
                        cssStatus.className = 'error';
                    }
                })
                .catch(error => {
                    cssStatus.textContent = 'CSS ошибка: ' + error.message;
                    cssStatus.className = 'error';
                });
        }
        
        // Проверяем Telegram Web App
        function checkTelegram() {
            const telegramStatus = document.getElementById('telegram-status');
            
            if (window.Telegram && window.Telegram.WebApp) {
                telegramStatus.textContent = 'Telegram Web App доступен ✓';
                telegramStatus.className = 'success';
                
                const tg = window.Telegram.WebApp;
                console.log('Telegram Web App:', tg);
                console.log('Init data:', tg.initData);
                console.log('Init data unsafe:', tg.initDataUnsafe);
            } else {
                telegramStatus.textContent = 'Telegram Web App недоступен (нормально для браузера)';
                telegramStatus.className = 'info';
            }
        }
        
        // Перехватываем ошибки
        window.addEventListener('error', function(e) {
            console.error('JavaScript error:', e);
            const errorList = document.getElementById('error-list');
            const li = document.createElement('li');
            li.textContent = e.message + ' (строка ' + e.lineno + ')';
            li.className = 'error';
            errorList.appendChild(li);
        });
        
        // Запускаем проверки
        checkResources();
        checkTelegram();
        
        console.log('Debug script completed');
    </script>
</body>
</html>
